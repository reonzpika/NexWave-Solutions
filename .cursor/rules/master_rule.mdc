---
description: "Master Rule - Comprehensive governance for multi-project management and documentation integrity"
alwaysApply: false
globs: []
---

# Master Rule

## Quick Reference - Critical Rules
1. **PROJECT_SUMMARY.md REQUIRED**: Every project MUST have `PROJECT_SUMMARY.md` - create immediately if missing
2. **Single Source of Truth**: `PROJECTS_OVERVIEW.md` = global dashboard; `PROJECT_SUMMARY.md` = project truth
3. **User Intent**: Assume users can't write good prompts - understand intent, clarify ambiguities, research proactively
4. **Template-Driven**: Auto-select templates, load on-demand only, adapt folder structures
5. **Update Dashboard**: After major changes, update `PROJECTS_OVERVIEW.md` with highlights and status

## Core Principles
- **PROJECT_SUMMARY.md Mandatory**: Every project folder MUST have exactly one `PROJECT_SUMMARY.md` (living source-of-truth). Create immediately if missing.
- **Single Source of Truth**: `PROJECTS_OVERVIEW.md` = global dashboard; `PROJECT_SUMMARY.md` = project canonical record
- **User Intent Understanding**: Follow guidelines in `.cursor/rules/ai-character.mdc` - understand underlying intent, clarify ambiguities, research proactively, don't assume knowledge.
- **Document Consolidation**: Avoid new documents unless substantially new. Consolidate into `PROJECT_SUMMARY.md` with date tags.
- **Template-First**: Use `/Templates/` for new projects. Auto-select based on stage/type. Load on-demand only.
- **Traceability**: Date-stamp all significant changes. Update `last_updated` and bump `version` (patch).

## System Structure (Workspace/Repository Level)
**Overall Structure**:
- **Root Level**: `PROJECTS_OVERVIEW.md` (global dashboard), `/Templates/` (templates + index)
- **Project Level**: Each project = one directory containing `PROJECT_SUMMARY.md` (MANDATORY per project)

**Prohibited**:
- Multiple `PROJECT_SUMMARY.md` files per project directory
- Project directories without `PROJECT_SUMMARY.md`
- Storing authoritative project data outside the project's `PROJECT_SUMMARY.md`

## Metadata (YAML Front Matter)
**Required**: `project_name`, `project_stage` (Ideation|Validation|Build|Operational|Archived), `owner`, `last_updated` (ISO), `version` (semver), `tags`
**Optional**: `summary`, `links`, `stakeholders`, `milestones`, `risks`
**Validation**: Ensure required fields exist, normalize stage, update `last_updated` on material edits, bump patch version.

## Dashboard (`PROJECTS_OVERVIEW.md`)
**Purpose**: Mission control dashboard - immediate snapshot, onboarding, cross-project visibility

**Structure**:
- Active Projects Index (name, folder, stage, owner, last updated, link to `PROJECT_SUMMARY.md`)
- AI-Generated Highlights (achievements, blockers, cross-project themes)
- Quick Status Summary (counts by stage)
- Project Details (brief per project: dates, status, summary)
- Archived Projects

**Update Triggers**: New project, stage change, archiving, major milestones, blockers identified, owner change, significant status updates

**Update Process**: 1) Update index table, 2) Refresh highlights, 3) Update status counts, 4) Update project details, 5) Update YAML `last_updated`, 6) Validate links

## PROJECT_SUMMARY.md Management
**Requirement**: Always required, non-negotiable. Living source-of-truth for all project info.

**Content**: Overview, goals, milestones, tasks, decisions, links, status, insights, learnings, progress updates

**Maintenance**: Update atomically, use date tags (`## Updates [2024-01-15]`), consolidate related info, prompt before overwriting/deleting significant info

**Validation**: If missing, create immediately using template. Ensure present and current before completing work.

## Templates

### Loading (On-Demand Only)
**Triggers**: New project with sparse metadata, user requests setup, missing folders/files detected, project matches template keywords
**Strategy**: Load only selected template (not all), use `Templates_Index.md` for quick reference

### Selection
- Auto-select based on: project description, metadata, stage, keywords from index
- Don't ask users to pick - make selection automatically
- If no match: research project type, auto-generate template, update index

### Structure Standards
Each template must include: YAML (`template_type`, `keywords`, `stage`), Purpose, Key Questions, Common Documents, Recommended Folder Structure, Milestones, Pitfalls, Example Prompts, Date-stamped footer

### Usage During Setup
1. Use Key Questions as conversation scaffold
2. AI-Guided Consultation: Prompt for missing details (stage, product type, function, requirements)
3. Adaptive Folder Creation: Start with template structure, customize by project type/model/stage, document rationale
4. Reference Common Documents, track Milestones, heed Pitfalls
5. Consolidate all info into `PROJECT_SUMMARY.md`

## AI-Guided Folder Creation

### Process
1. **Gather Context**: Review metadata, prompt for missing details (stage, product type, business function, team size, requirements), analyze description, ask clarifying questions
2. **Select Template**: Match by stage/type, review recommended structure
3. **Customize**: Start with template, add folders by product type (SaaS: `/api/`, `/frontend/`), business model (marketplace: `/seller-onboarding/`, `/payment-processing/`), compliance (`/compliance/`, `/dpia/`), grants (`/grant-proposals/`), partnerships (`/partner-contracts/`). Remove/defer irrelevant folders.
4. **Document**: Note rationale in `PROJECT_SUMMARY.md`, reference template, explain adaptations
5. **Future-Proof**: Flexible structure, anticipate needs but don't over-engineer, add folders as project evolves

### Evolution
- **Stage-Based**: Ideation→Validation (add research), Validation→Build (add development), Build→Operational (add operations)
- **Business Model**: SaaS (dev/deploy/ops), Marketplace (buyer/seller/payments/trust), Hardware (manufacturing/supply/certs), Research/Grants (proposals/compliance/reporting), Consulting (clients/proposals/deliverables)
- **Continuous**: Detect gaps, suggest folders, adapt structure, update documentation

## Project Creation Workflow
1. **Gather Details**: Prompt for stage, product type, business function, team size, requirements. Infer if sparse, ask clarifying questions.
2. **Create Directory**: Use kebab-case naming
3. **Create PROJECT_SUMMARY.md**: IMMEDIATELY (mandatory)
4. **Select Template**: Auto-select based on stage/type
5. **Populate PROJECT_SUMMARY.md**: From template with required YAML
6. **Create Folders**: Start with template structure, customize by gathered details, document rationale
7. **Update Dashboard**: Add row to `PROJECTS_OVERVIEW.md`

## Research and Data Gathering
- **Follow communication principles**: Reference `.cursor/rules/ai-character.mdc` for user intent understanding guidelines
- **Research proactively**: Conduct internet research to fill gaps, inform decisions
- **When researching**: Indicate sources, date-stamp findings

## File and Folder Updates
- **Missing PROJECT_SUMMARY.md**: Critical error - create immediately before proceeding
- **Missing Folders**: Consult user, reference templates, create adaptively
- **Document Creation**: Avoid new docs unless substantially new. Consolidate into `PROJECT_SUMMARY.md` when in doubt.
- **Updates**: Minimal diffs, consolidate with date tags, use kebab-case naming
- **Confirmations**: Prompt before overwriting/deleting significant info, renames, deletions, cross-project moves

## Consistency and Synchronization
- Update `last_updated` and bump `version` (patch) in both `PROJECT_SUMMARY.md` and `PROJECTS_OVERVIEW.md`
- Keep dashboard in sync with status/stage, milestones, blockers, achievements
- Reflect decisions/milestones immediately in both files
- Surface cross-project dependencies in dashboard highlights
- Ensure dashboard provides accurate at-a-glance visibility

## Operational Loop
1. Read Master Rule
2. Validate context - ask if unclear
3. **PROJECT_SUMMARY.md Check**: Verify exists, create if missing (CRITICAL)
4. **Template Selection** (if triggered): Check index, auto-select, load only selected file
5. **Template Usage** (if loaded): Use Key Questions, prompt for details, create adaptive folders, consolidate into `PROJECT_SUMMARY.md`
6. **Research**: If info incomplete, research proactively
7. Validate metadata in `PROJECT_SUMMARY.md`
8. Plan edits - prefer updating `PROJECT_SUMMARY.md` and `PROJECTS_OVERVIEW.md` directly
9. Prompt before destructive changes
10. Apply edits atomically, update metadata, date-stamp
11. **Update Dashboard**: After major changes, update index, refresh highlights, update counts/details, update YAML
12. Final validation: Ensure `PROJECT_SUMMARY.md` reflects all changes
13. Summarize changes

### Validation Checkpoints
- **After Step 3**: Verify `PROJECT_SUMMARY.md` has required YAML fields (if exists)
- **After Step 5**: Verify template was loaded correctly (if applicable)
- **After Step 10**: Verify metadata updates are valid (semver format, ISO date, valid stage enum)
- **After Step 11**: Verify dashboard links are valid, highlights are formatted correctly
- **After Step 12**: Final validation - all changes reflected, no inconsistencies between files

## Decision Trees for Common Scenarios

### Ambiguous Project Selection
When user says "my project" or project name is unclear:
1. Check `PROJECTS_OVERVIEW.md` Active Projects Index
2. If 1 active project: Confirm project name with user ("Assuming you mean [Project Name]?")
3. If multiple active projects: List projects with brief context (stage, last updated), ask user to specify
4. If no active projects: Check archived projects, ask if reviving archived project
5. If still unclear: Ask for project folder name or key identifier

### Template Inference from Folder Structure
If `PROJECT_SUMMARY.md` missing but folder exists:
1. Analyze folder contents and file names
2. Match against template keywords in `Templates_Index.md`:
   - Look for folder names that match template keywords
   - Check for common files (e.g., `pitch-deck.md` → Fundraising, `user-stories.md` → Product Development)
   - Identify stage indicators (e.g., `customer-interviews/` → Idea Validation)
3. Select best-fit template based on folder structure analysis
4. If cannot infer: Prompt user for project stage and type to select template

### Template Composition Strategy
When auto-generating template (no exact match):
1. **Identify Primary Template**: Best match based on stage or primary function
2. **Identify Secondary Templates**: Additional templates that contribute relevant elements
3. **YAML Front Matter**: Use primary template as base, merge unique tags/fields from secondary
4. **Key Questions**: Combine unique questions, remove duplicates, maintain logical flow
5. **Folder Structure**: 
   - Merge structures from all templates
   - Resolve conflicts by priority: Current stage > Product type > General
   - Remove duplicates, keep most specific recommendations
6. **Milestones**: Merge chronologically, remove duplicates, ensure logical progression
7. **Pitfalls**: Combine all unique pitfalls from all templates
8. **Common Documents**: Merge lists, remove duplicates
9. **Conflict Resolution**: If conflicting guidance (e.g., different approaches):
   - Document both approaches with explanations
   - Explain trade-offs
   - Default to primary template's approach
   - Note conflict resolution in template rationale
10. **Documentation**: In template, note which templates were combined and why

## Standard Documentation Formats

### Cross-Project Dependencies
**Location**: Document in both projects' `PROJECT_SUMMARY.md` under `## Dependencies` section

**Format**:
```markdown
## Dependencies [2024-01-15]

### Outgoing Dependencies
- **[Project Name]** - [Type: Data/Resource/Integration/API] - [Description] - [Status: Active/Blocked/Resolved]

### Incoming Dependencies  
- **[Project Name]** depends on this project for [Description] - [Status: Active/Blocked/Resolved]

### Notes
[Any additional context about dependencies]
```

**Update Process**: When dependency identified:
1. Update both projects' `PROJECT_SUMMARY.md` with dependency info
2. Update `PROJECTS_OVERVIEW.md` Cross-Project Themes & Dependencies section
3. Date-stamp the dependency entry
4. Update dashboard highlights if dependency affects project status

### Consolidated Information Structure
When consolidating scattered information into `PROJECT_SUMMARY.md`:

**Format**: `## [Topic] [Date]`

**Organization**:
- Group by topic: Goals, Decisions, Learnings, Risks, Blockers, Insights, Updates
- Date-stamp each entry
- Maintain chronological order within sections
- Preserve original context/source if relevant: `[Source: filename.md]`

**Example Structure**:
```markdown
## Decisions [2024-01-15]

### Technology Stack Decision [2024-01-10]
[Decision details] - [Rationale] - [Source: tech-meeting-notes.md]

### Pricing Model Decision [2024-01-12]
[Decision details] - [Rationale] - [Source: business-planning.md]
```

## Rules of Thumb

### When to Research vs. Ask User
- **Research**: Industry standards, best practices, common patterns, typical approaches, market data
- **Ask User**: Project-specific details, preferences, constraints, team capabilities, business context

### When to Create New Document vs. Consolidate
- **New Document**: Substantially new topic unrelated to existing content, different domain/function
- **Consolidate**: Related information, updates, variations of same topic, refinements

### Template Selection Confidence
- **High confidence (>80% keyword match)**: Auto-select immediately, explain reasoning briefly
- **Medium confidence (50-80%)**: Auto-select but explain reasoning, offer to adjust if needed
- **Low confidence (<50%)**: Research project type first, then select or generate, explain process

### Dashboard Update Frequency
- **Immediate**: Stage changes, major milestones, project creation/archiving, blocker identification
- **Can Defer**: Minor updates can batch, update on next major change (unless user specifically requests immediate update)

## Error Handling
- **Missing PROJECT_SUMMARY.md**: Critical - create immediately using template (use Decision Tree for template inference)
- **Unclear user intent**: Follow guidelines in `.cursor/rules/ai-character.mdc` - don't assume, use context-aware clarification, research context
- **Ambiguous project selection**: Use Decision Tree for Ambiguous Project Selection
- **Missing/invalid metadata**: Prompt for exact fields needed, don't assume users know requirements
- **Conflicting information**: Surface conflict, ask for resolution, update `PROJECT_SUMMARY.md`
- **Template not found**: Use Template Composition Strategy to auto-generate (don't ask user to approve)
- **Information scattered**: Consolidate into `PROJECT_SUMMARY.md` using Standard Documentation Formats
- **Knowledge gaps**: Research proactively rather than asking user

## Safeguards
- Never work on project without `PROJECT_SUMMARY.md` - verify first, create if missing
- Never create multiple sources of truth - `PROJECT_SUMMARY.md` is single source per project
- Never proceed with destructive operations without confirmation
- Keep edits scoped - avoid cross-project edits unless explicit
- Always update `PROJECT_SUMMARY.md` to reflect latest state - living document

---

# End of Master Rule
