---
description: "Master Rule - Comprehensive governance for multi-project management and documentation integrity"
alwaysApply: false
globs: []
---

# Master Rule

## Purpose and Scope
This document is the authoritative source of truth for how the AI manages multiple projects, enforces documentation consistency, validates metadata, and delegates to domain-specific rules. It defines the policies, workflows, and safeguards that ensure reliable, repeatable project operations.

## Core Principles
- Single Source of Truth: Root `PROJECTS_OVERVIEW.md` is the global dashboard; each project folder has exactly one `PROJECT_SUMMARY.md` as the project's canonical record.
- Minimal Surprises: Structural or destructive changes require explicit confirmation.
- Consistency Over Time: Keep metadata and content synchronized; avoid drift between instructions, files, and memory.
- Document Consolidation: Avoid creating new documents unless the topic is substantially new and unrelated to existing documents. Consolidate related information within existing central files using clear section headings and date tags.
- Template-First: Prefer `/Templates/` for creating new projects or augmenting structure; create a new template only when none is suitable.
- Delegation: The short dispatcher (`.cursor/rules/current-task.mdc`) governs the interactive loop; this Master Rule governs policies and execution details.
- Traceability: Keep all output in clean Markdown with dates for traceability. Date-stamp significant changes and updates.

## Project Structure and Governance
- Root level contains:
  - Global `PROJECTS_OVERVIEW.md` dashboard summarizing all projects.
  - `/Templates/` containing scenario templates and an index.
  - One directory per project with its own `PROJECT_SUMMARY.md`.
- Prohibited:
  - Multiple `PROJECT_SUMMARY.md` files in the same project folder.
  - Storing authoritative project data outside the project `PROJECT_SUMMARY.md`.

## Metadata Policy (YAML front matter)
All root `PROJECTS_OVERVIEW.md` and project `PROJECT_SUMMARY.md` files must begin with YAML front matter.

Required fields:
- `project_name` (string)
- `project_stage` (enum: Ideation | Validation | Build | Operational | Archived)
- `owner` (string)
- `last_updated` (ISO date string)
- `version` (semver string)
- `tags` (array of strings)

Optional fields:
- `summary`, `links` (map of name->url), `stakeholders` (array), `milestones` (array), `risks` (array)

Validation rules:
- Ensure required fields exist and are non-empty.
- `version` must be a valid semver (e.g., 1.0.0). If unsure, bump patch.
- `last_updated` must be set to current date when material edits occur.
- Normalize `project_stage` to one of the allowed values; prompt if ambiguous.

## Dashboard Management (Root `PROJECTS_OVERVIEW.md`)
- Maintain a table of active projects with folder, status/stage, and last updated.
- When creating a new project, add a row immediately.
- When archiving, move the row to an Archived section or clearly mark status.

## Project `PROJECT_SUMMARY.md` Management
- Treat it as the single source of truth for: overview, goals, milestones, tasks, decisions, links, and status.
- When user requests updates, modify this file directly and atomically.
- Keep sections tidy; prefer concise headings and tables where appropriate.
- Consolidate related information within this file using clear section headings and date tags (e.g., `## Updates [2024-01-15]`).
- Before overwriting or deleting significant project information, always prompt the user for clarification and confirmation.

## Templates

### Triggered Template Loading
AI should load templates **on-demand** only at specific trigger points:
- A new project folder is detected with sparse metadata
- The user requests project setup assistance
- AI detects gaps or missing standard folders/files in an existing project
- User's project description or stage matches template keywords

**Loading Strategy**: Load only the selected template file (not all templates) to minimize context overhead and keep processing focused.

### Templates Index
- Maintain `Templates_Index.md` at the root of the `/Templates/` folder as a concise reference.
- The index contains: template name, keywords, stage, and use case - kept minimal to reduce context size.
- AI refers to this index first to quickly identify which template to load based on:
  - User conversation keywords
  - Project metadata (stage, tags, description)
  - Detected gaps in project structure
- Update the index whenever adding new templates.

### AI-Driven Template Selection
- Automatically select the best-fit template by analyzing the user's project description, metadata, and current stage.
- Match templates using:
  - Keywords from Templates Index
  - Project stage alignment
  - User's stated goals or needs
- **Do not ask users to pick templates** - make the selection automatically based on context.
- If no suitable template exists:
  1. Perform online research to infer the project type and best practices
  2. Auto-generate a new template markdown file following the standard template structure
  3. Update `Templates_Index.md` with the new template entry
  4. Save the template for future reuse

### Template Structure Standards
Each template markdown file must include:
- **YAML front matter** with: `template_type`, `keywords` (array), `stage` (enum)
- **Purpose of This Stage/Scenario** - Clear description of when to use this template
- **Key Questions for Founders** - Questions to guide information gathering
- **Common Documents to Prepare** - List of expected deliverables
- **Recommended Folder Structure Components** - Suggested folder/file organization with examples
- **Typical Milestones and Checkpoints** - Stage progression markers
- **Pitfalls to Avoid** - Common mistakes to warn about
- **Example Prompts for AI** - Reference prompts for AI during setup conversations
- **Date-stamped footer** for traceability

### Using Templates During Project Setup
When a template is loaded:
1. Use the template's **Key Questions** as a conversation scaffold to gather required information
2. Reference **Recommended Folder Structure** to create project folder and subfolder structure
3. Use **Common Documents** list to identify what needs to be created
4. Track progress against **Typical Milestones** and advise on next steps
5. Reference **Pitfalls to Avoid** for coaching throughout setup
6. Use **Example Prompts** as reference for productive conversations

### Proactive Research and Data Gathering
- Recognize that users often lack full information; proactively conduct supplementary internet research to help fill gaps.
- Use research to inform template selection and content generation.
- Present suggestions, best practices, and relevant data tailored to the user's project goals.
- This collaborative approach improves data quality and helps the user learn.
- When conducting research, clearly indicate sources and date-stamp findings.

## Creation and Update Semantics
- File creation: Create missing project directories and `PROJECT_SUMMARY.md` atomically; populate from a template.
- Avoid creating new documents unless the topic is substantially new and unrelated to existing documents.
- File updates: Make minimal diffs; do not introduce unrelated changes. When adding new information, consolidate within existing files using clear section headings and date tags.
- Naming: Use kebab-case for directories; avoid spaces where feasible.
- Confirmations: Always prompt the user for clarification before overwriting or deleting significant project information. Ask for confirmation before renames, deletions, or moving content across projects.
- Date-stamping: Include date tags (e.g., `[2024-01-15]`) for significant changes and updates to maintain traceability.

## Consistency and Synchronization
- Update `last_updated` and bump `version` (patch) for meaningful changes.
- Keep root dashboard in sync with project status/stage.
- Reflect decisions and milestones immediately to prevent drift.

## Delegation to Domain Rules
- If a domain- or folder-specific rule exists (e.g., under `.cursor/rules/`), follow it for that domain while preserving the principles here.
- The dispatcher rule (`current-task.mdc`) controls the task loop; this Master Rule defines how to perform the work.

## Error Handling and Ambiguities
- Missing/invalid metadata: prompt the user with the exact fields needed.
- Conflicting information: surface the conflict and ask for resolution.
- Template not found: propose the closest template and, if approved, create a new one.

## Operational Loop (When Invoked)
1. Read this Master Rule.
2. Validate context (project, folder, intended change). If unclear, ask for confirmation.
3. **Template Selection (Triggered Loading)**:
   - **Check triggers**: New project folder with sparse metadata? User requesting setup? Missing standard folders/files? Project description matches template keywords?
   - If triggered: Check `Templates_Index.md` first (concise reference only).
   - Analyze user's project description, metadata, and stage to auto-select best-fit template.
   - Load **only the selected template file** (not all templates) to keep context focused.
   - If no suitable template exists, conduct research and auto-generate a new template following Template Structure Standards.
4. **Template Usage**: If a template is loaded:
   - Use template's **Key Questions** as conversation scaffold to gather information.
   - Reference **Recommended Folder Structure** to create project organization.
   - Use **Common Documents** list to identify deliverables.
   - Track progress against **Typical Milestones**.
   - Reference **Pitfalls to Avoid** for guidance.
5. **Research and Data Gathering**: If user information is incomplete, proactively conduct supplementary research to fill gaps and present suggestions.
6. Validate metadata and collect missing fields.
7. Plan minimal edits; prefer updating `PROJECT_SUMMARY.md` and `PROJECTS_OVERVIEW.md` directly. Consolidate related information within existing files rather than creating new documents.
8. Before making destructive changes, prompt user for clarification and confirmation.
9. Apply the edits atomically; update metadata (`last_updated`, `version`). Include date tags for traceability.
10. Update the root dashboard if project status changed.
11. Summarize changes succinctly and confirm completion.

## Safeguards
- Never create multiple sources of truth.
- Never proceed with destructive operations without confirmation.
- Keep edits scoped; avoid cross-project edits unless explicitly requested.

---

# End of Master Rule
